@model Bloggie.Web.Models.ViewModels.EditBlogPostRequest

@{
    ViewBag.Title = "Edit Blog Post";
    Layout = "~/Views/Shared/_Layout.cshtml";
}





<!-- Centered Header Section -->
<div class="container mt-2">
    <div class="row justify-content-center">
        <div class="col-lg-12">
            <!-- Card with elegant shadow & subtle color -->
            <div class="card border-0 rounded-4 px-3 py-1"
                 style="box-shadow: rgba(0, 0, 0, 0.15) 0px 4px 12px;">

                <div class="row g-4 align-items-center">
                    <div class="col-md-12 text-center">
                        <h1 class="fw-bold text-primary-emphasis"
                            style="font-size: 2.8rem; font-weight: 700;
                   background: linear-gradient(to right, #0d6efd, #6610f2);
                   -webkit-background-clip: text ;
                   -webkit-text-fill-color: transparent;
                   text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);">

                            <i class="fe-edit me-2"></i>
                            Share Your Thoughts with the World
                        </h1>
                        <p class="text-muted fs-5">
                            Write and publish your blog to inspire others!
                        </p>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>



<!-- Main Container -->
<div class="container">
    <div class="row justify-content-center">
        <div class="col-lg-12">
            <!-- Increased width for a more spacious layout -->
            <div class="card border-0 rounded-4 px-2 py-3"
                 style="box-shadow: rgba(0, 0, 0, 0.15) 0px 4px 12px;">
                <!-- Border is now darker & visible -->

                    <div class="row g-4 align-items-center">
                        <!-- Well-spaced layout -->
                        <div class="col-md-12">


                        <h2 class="text-center text-primary fw-bold mb-3"
                            style="font-weight: 700;
                   background: linear-gradient(to right, #0d6efd, #6610f2);
                   -webkit-background-clip: text ;
                   -webkit-text-fill-color: transparent;
                   text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);">
                            Change Your Current Blog
                        </h2>


                            @if (Model != null)
                            {
                                <form method="post">


                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Heading</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="id" asp-for="Id" readonly style="border: 1px solid lightgray;" />

                                    </div>


                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Heading</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="heading" asp-for="Heading" style="border: 1px solid lightgray;" />

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Page Title</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="pageTitle" asp-for="PageTitle" style="border: 1px solid lightgray;" />

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Content</label>
                                        <textarea class="form-control rounded-3 shadow-sm px-3 py-2" id="content" asp-for="Content" style="border: 1px solid lightgray;"></textarea>

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Short Description</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="shortDescription" asp-for="ShortDescription" style="border: 1px solid lightgray;" />

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Featured Image Upload</label>
                                        <input type="file" class="form-control rounded-3 shadow-sm px-3 py-2" id="featuredImageUpload" style="border: 1px solid lightgray;" />
                                        @if (Model.FeaturedImageUrl != null)
                                        {
                                            <img src="@Model.FeaturedImageUrl" id="featuredImageDisplay" style="display:block; width:300px" />
                                        }
                                        else
                                        {
                                            <img src="" id="featuredImageDisplay" style="display:none; width:300px" style="border: 1px solid lightgray;" />
                                        }
                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Featured Image URL</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="featuredImageUrl" asp-for="FeaturedImageUrl" style="border: 1px solid lightgray;" />

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">URL Handle</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="urlHandle" asp-for="UrlHandle" style="border: 1px solid lightgray;" />

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">Published Date</label>
                                        <input type="date" class="form-control rounded-3 shadow-sm px-3 py-2" id="publishedDate" asp-for="PublishedDate" style="border: 1px solid lightgray;" />

                                    </div>

                                    <div class="mb-3">

                                        <label class="form-label fw-semibold text-primary">author</label>
                                        <input type="text" class="form-control rounded-3 shadow-sm px-3 py-2" id="author" asp-for="Author" style="border: 1px solid lightgray;" />

                                    </div>


                                    <div class="d-flex align-items-center mb-3">
                                        <div class="form-check form-switch m-0">
                                            <input class="form-check-input shadow-sm" type="checkbox" id="visible" asp-for="Visible"
                                                   style="width: 50px; height: 25px; cursor: pointer;">
                                        </div>
                                        <label class="ms-2 fw-semibold text-primary" for="visible">
                                            Do you accept our Terms & Conditions ?
                                        </label>
                                    </div>

                                    <div class="mb-3">
                                        <label class="form-label fw-semibold text-primary">Tags</label>
                                        <select class="form-select shadow-sm px-3 py-2"
                                                asp-items="Model.Tags"
                                                asp-for="SelectedTags" multiple
                                                style="height: 100px; overflow-y: auto;">
                                        </select>
                                    </div>

                                    <div class="mb-3 d-flex">
                                        <button type="submit" class="btn btn-dark">Update</button>

                                        <button type="submit" class="btn btn-danger ms-2"
                                                asp-area=""
                                                asp-controller="AdminBlogPosts"
                                                asp-action="Delete">
                                            Delete
                                        </button>
                                    </div>

                                </form>
                            }

                            else
                            {
                                <p>No blog post found</p>
                            }





                        </div>


                    </div>

                </div>
            </div>
        </div>
    </div>





    <script>

        var editor = new FroalaEditor('#content',{
                   imageUploadURL: '/api/Image/UploadAsync'
        });



          const featuredUploadElement = document.getElementById('featuredImageUpload');

        const featuredImageUrlElement = document.getElementById('featuredImageUrl');

        const featuredImageDisplayElement = document.getElementById('featuredImageDisplay');

               async function UploadFeaturedImage(e) {
                   console.log(e.target.files[0]);

                   let data = new FormData();
                   data.append('file',e.target.files[0]);

                   await fetch ('/api/Image/UploadAsync', {
                       method: 'POST',
                       header: {
                           'Accept': '*/*',
                       },
                       body: data
                   }).then(response => response.json())
                     .then(result => {
                                featuredImageUrlElement.value = result.link;
                                featuredImageDisplayElement.src = result.link;
                                featuredImageDisplayElement.style.display = 'block';
                     });


               }



        featuredUploadElement.addEventListener('change', UploadFeaturedImage)

    </script>
